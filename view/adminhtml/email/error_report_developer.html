<!--
  ~ Copyright (c) 2025. Volodymyr Hryvinskyi. All rights reserved.
  ~ Author: Volodymyr Hryvinskyi <volodymyr@hryvinskyi.com>
  ~ GitHub: https://github.com/hryvinskyi
  -->
<!--@subject {{trans "Error Alert: %error_message" error_message=$error.message}} @-->
<!--@vars {
"var error":"array",
"var request":"array",
"var client":"array",
"var store.getFrontendName()":"Store Name",
"var frontend_store":"array",
"var user":"array",
"var environment":"array",
"var trace":"string",
"var post_data":"array",
"var timestamp_formatted":"string",
"var area":"string"
} @-->
<html>
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
</head>
<body style="margin: 0; padding: 0; background-color: #f4f4f4; font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, 'Helvetica Neue', Arial, sans-serif;">
<table role="presentation" style="width: 100%; border-collapse: collapse; background-color: #f4f4f4; padding: 40px 0;">
    <tr>
        <td align="center">
            <table role="presentation" style="width: 600px; border-collapse: collapse; background-color: #ffffff; border-radius: 8px; box-shadow: 0 4px 12px rgba(0,0,0,0.15);">
                <!-- Header -->
                <tr>
                    <td style="background: linear-gradient(135deg, #f44336 0%, #d32f2f 100%); padding: 40px 30px; text-align: center; border-radius: 8px 8px 0 0;">
                        <div style="background-color: rgba(255,255,255,0.2); border-radius: 50%; width: 80px; height: 80px; margin: 0 auto 20px; display: flex; align-items: center; justify-content: center;">
                            <span style="font-size: 48px;">⚠️</span>
                        </div>
                        <h1 style="margin: 0; color: #ffffff; font-size: 28px; font-weight: 600;">{{trans "Application Error Detected"}}</h1>
                        <p style="margin: 10px 0 0 0; color: #ffffff; opacity: 0.9; font-size: 16px;">
                            {{trans "Severity:"}} <strong style="text-transform: uppercase;">{{var error.severity}}</strong>
                        </p>
                    </td>
                </tr>

                <!-- Alert Message -->
                <tr>
                    <td style="padding: 40px 30px;">
                        <div style="background-color: #fff3cd; border-left: 4px solid #ff9800; padding: 16px 20px; margin-bottom: 30px; border-radius: 4px;">
                            <p style="margin: 0; color: #856404; font-size: 16px; font-weight: 500;">
                                ⚠ {{trans "An error has occurred on your website"}}
                            </p>
                        </div>

                        <p style="color: #333; font-size: 16px; line-height: 1.6; margin: 0 0 30px 0;">
                            {{trans "This is an automated alert from the %store_name error monitoring system." store_name=$frontend_store.name}}
                        </p>

                        <!-- Error Details -->
                        <table style="width: 100%; border-collapse: collapse; margin-bottom: 30px;">
                            <tr>
                                <td colspan="2" style="padding: 12px 16px; background-color: #f44336; color: #ffffff; font-size: 16px; font-weight: 600;">
                                    {{trans "Error Details"}}
                                </td>
                            </tr>
                            <tr>
                                <td style="padding: 12px 16px; background-color: #f8f9fa; border-bottom: 1px solid #e9ecef; color: #666; font-size: 14px; width: 35%;">
                                    <strong>{{trans "Error Type:"}}</strong>
                                </td>
                                <td style="padding: 12px 16px; background-color: #ffffff; border-bottom: 1px solid #e9ecef; color: #333; font-size: 14px; word-break: break-word;">
                                    {{var error.type}}
                                </td>
                            </tr>
                            <tr>
                                <td style="padding: 12px 16px; background-color: #f8f9fa; border-bottom: 1px solid #e9ecef; color: #666; font-size: 14px;">
                                    <strong>{{trans "Message:"}}</strong>
                                </td>
                                <td style="padding: 12px 16px; background-color: #ffffff; border-bottom: 1px solid #e9ecef; color: #d32f2f; font-size: 14px; word-break: break-word;">
                                    <strong>{{var error.message}}</strong>
                                </td>
                            </tr>
                            <tr>
                                <td style="padding: 12px 16px; background-color: #f8f9fa; border-bottom: 1px solid #e9ecef; color: #666; font-size: 14px;">
                                    <strong>{{trans "File:"}}</strong>
                                </td>
                                <td style="padding: 12px 16px; background-color: #ffffff; border-bottom: 1px solid #e9ecef; color: #333; font-size: 13px; font-family: 'Courier New', monospace; word-break: break-all;">
                                    {{var error.file}}
                                </td>
                            </tr>
                            <tr>
                                <td style="padding: 12px 16px; background-color: #f8f9fa; border-bottom: 1px solid #e9ecef; color: #666; font-size: 14px;">
                                    <strong>{{trans "Line:"}}</strong>
                                </td>
                                <td style="padding: 12px 16px; background-color: #ffffff; border-bottom: 1px solid #e9ecef; color: #333; font-size: 14px;">
                                    {{var error.line}}
                                </td>
                            </tr>
                            <tr>
                                <td style="padding: 12px 16px; background-color: #f8f9fa; border-bottom: 1px solid #e9ecef; color: #666; font-size: 14px;">
                                    <strong>{{trans "Timestamp:"}}</strong>
                                </td>
                                <td style="padding: 12px 16px; background-color: #ffffff; border-bottom: 1px solid #e9ecef; color: #333; font-size: 14px;">
                                    {{var timestamp_formatted}}
                                </td>
                            </tr>
                            <tr>
                                <td style="padding: 12px 16px; background-color: #f8f9fa; color: #666; font-size: 14px;">
                                    <strong>{{trans "Error Hash:"}}</strong>
                                </td>
                                <td style="padding: 12px 16px; background-color: #ffffff; color: #666; font-size: 11px; font-family: 'Courier New', monospace; word-break: break-all;">
                                    {{var error.hash}}
                                </td>
                            </tr>
                        </table>

                        <!-- Request Information -->
                        <table style="width: 100%; border-collapse: collapse; margin-bottom: 30px;">
                            <tr>
                                <td colspan="2" style="padding: 12px 16px; background-color: #2196f3; color: #ffffff; font-size: 16px; font-weight: 600;">
                                    {{trans "Request Information"}}
                                </td>
                            </tr>
                            <tr>
                                <td style="padding: 12px 16px; background-color: #f8f9fa; border-bottom: 1px solid #e9ecef; color: #666; font-size: 14px; width: 35%;">
                                    <strong>{{trans "URL:"}}</strong>
                                </td>
                                <td style="padding: 12px 16px; background-color: #ffffff; border-bottom: 1px solid #e9ecef; color: #2196f3; font-size: 13px; word-break: break-all;">
                                    <a href="{{var request.url}}" style="color: #2196f3; text-decoration: none;">{{var request.url}}</a>
                                </td>
                            </tr>
                            <tr>
                                <td style="padding: 12px 16px; background-color: #f8f9fa; border-bottom: 1px solid #e9ecef; color: #666; font-size: 14px;">
                                    <strong>{{trans "Method:"}}</strong>
                                </td>
                                <td style="padding: 12px 16px; background-color: #ffffff; border-bottom: 1px solid #e9ecef; color: #333; font-size: 14px;">
                                    {{var request.method}}
                                </td>
                            </tr>

                            {{if post_data}}
                            <tr>
                                <td style="padding: 12px 16px; background-color: #f8f9fa; border-bottom: 1px solid #e9ecef; color: #666; font-size: 14px; vertical-align: top;">
                                    <strong>{{trans "Post Data:"}}</strong>
                                </td>
                                <td style="padding: 12px 16px; background-color: #ffffff; border-bottom: 1px solid #e9ecef; color: #333; font-size: 14px; word-break: break-all; font-family: 'Courier New', monospace;">
                                    {{var post_data|raw}}
                                </td>
                            </tr>
                            {{/if}}
                            <tr>
                                <td style="padding: 12px 16px; background-color: #f8f9fa; border-bottom: 1px solid #e9ecef; color: #666; font-size: 14px;">
                                    <strong>{{trans "Area:"}}</strong>
                                </td>
                                <td style="padding: 12px 16px; background-color: #ffffff; border-bottom: 1px solid #e9ecef; color: #333; font-size: 14px;">
                                    {{var area}}
                                </td>
                            </tr>
                            <tr>
                                <td style="padding: 12px 16px; background-color: #f8f9fa; border-bottom: 1px solid #e9ecef; color: #666; font-size: 14px;">
                                    <strong>{{trans "Store:"}}</strong>
                                </td>
                                <td style="padding: 12px 16px; background-color: #ffffff; border-bottom: 1px solid #e9ecef; color: #333; font-size: 14px;">
                                    {{var frontend_store.name}} ({{var frontend_store.code}})
                                </td>
                            </tr>
                            <tr>
                                <td style="padding: 12px 16px; background-color: #f8f9fa; color: #666; font-size: 14px;">
                                    <strong>{{trans "Client IP:"}}</strong>
                                </td>
                                <td style="padding: 12px 16px; background-color: #ffffff; color: #333; font-size: 14px;">
                                    {{var client.ip}}
                                </td>
                            </tr>
                        </table>

                        <!-- User Context -->
                        {{depend user.type}}
                        <table style="width: 100%; border-collapse: collapse; margin-bottom: 30px;">
                            <tr>
                                <td colspan="2" style="padding: 12px 16px; background-color: #4caf50; color: #ffffff; font-size: 16px; font-weight: 600;">
                                    {{trans "User Context"}}
                                </td>
                            </tr>
                            <tr>
                                <td style="padding: 12px 16px; background-color: #f8f9fa; border-bottom: 1px solid #e9ecef; color: #666; font-size: 14px; width: 35%;">
                                    <strong>{{trans "Type:"}}</strong>
                                </td>
                                <td style="padding: 12px 16px; background-color: #ffffff; border-bottom: 1px solid #e9ecef; color: #333; font-size: 14px; text-transform: capitalize;">
                                    {{var user.type}}
                                </td>
                            </tr>
                            {{if user.email}}
                            <tr>
                                <td style="padding: 12px 16px; background-color: #f8f9fa; border-bottom: 1px solid #e9ecef; color: #666; font-size: 14px;">
                                    <strong>{{trans "Email:"}}</strong>
                                </td>
                                <td style="padding: 12px 16px; background-color: #ffffff; border-bottom: 1px solid #e9ecef; color: #333; font-size: 14px;">
                                    {{var user.email}}
                                </td>
                            </tr>
                            {{/if}}
                            {{if user.name}}
                            <tr>
                                <td style="padding: 12px 16px; background-color: #f8f9fa; color: #666; font-size: 14px;">
                                    <strong>{{trans "Name:"}}</strong>
                                </td>
                                <td style="padding: 12px 16px; background-color: #ffffff; color: #333; font-size: 14px;">
                                    {{var user.name}}
                                </td>
                            </tr>
                            {{/if}}
                        </table>
                        {{/depend}}

                        <!-- Stack Trace -->
                        {{depend trace}}
                        <div style="background-color: #f8f9fa; padding: 24px; border-radius: 6px; margin-bottom: 20px;">
                            <h2 style="margin: 0 0 16px 0; color: #333; font-size: 18px; font-weight: 600;">{{trans "Stack Trace:"}}</h2>
                            <div style="background-color: #ffffff; border: 1px solid #e9ecef; border-radius: 4px; padding: 16px; overflow-x: auto;">
                                <pre style="margin: 0; font-family: 'Courier New', monospace; font-size: 12px; line-height: 1.5; color: #333; white-space: pre-wrap; word-wrap: break-word;">{{var trace}}</pre>
                            </div>
                        </div>
                        {{/depend}}

                        <!-- Environment Info -->
                        {{depend environment.php_version}}
                        <table style="width: 100%; border-collapse: collapse; margin-bottom: 30px;">
                            <tr>
                                <td colspan="2" style="padding: 12px 16px; background-color: #9c27b0; color: #ffffff; font-size: 16px; font-weight: 600;">
                                    {{trans "Server Environment"}}
                                </td>
                            </tr>
                            <tr>
                                <td style="padding: 12px 16px; background-color: #f8f9fa; border-bottom: 1px solid #e9ecef; color: #666; font-size: 14px; width: 35%;">
                                    <strong>{{trans "PHP Version:"}}</strong>
                                </td>
                                <td style="padding: 12px 16px; background-color: #ffffff; border-bottom: 1px solid #e9ecef; color: #333; font-size: 14px;">
                                    {{var environment.php_version}}
                                </td>
                            </tr>
                            <tr>
                                <td style="padding: 12px 16px; background-color: #f8f9fa; border-bottom: 1px solid #e9ecef; color: #666; font-size: 14px;">
                                    <strong>{{trans "Memory Usage:"}}</strong>
                                </td>
                                <td style="padding: 12px 16px; background-color: #ffffff; border-bottom: 1px solid #e9ecef; color: #333; font-size: 14px;">
                                    {{var environment.memory_usage}}
                                </td>
                            </tr>
                            <tr>
                                <td style="padding: 12px 16px; background-color: #f8f9fa; border-bottom: 1px solid #e9ecef; color: #666; font-size: 14px;">
                                    <strong>{{trans "Memory Peak:"}}</strong>
                                </td>
                                <td style="padding: 12px 16px; background-color: #ffffff; border-bottom: 1px solid #e9ecef; color: #333; font-size: 14px;">
                                    {{var environment.memory_peak}}
                                </td>
                            </tr>
                            <tr>
                                <td style="padding: 12px 16px; background-color: #f8f9fa; color: #666; font-size: 14px;">
                                    <strong>{{trans "Memory Limit:"}}</strong>
                                </td>
                                <td style="padding: 12px 16px; background-color: #ffffff; color: #333; font-size: 14px;">
                                    {{var environment.memory_limit}}
                                </td>
                            </tr>
                        </table>
                        {{/depend}}

                        <!-- Note -->
                        <div style="background-color: #e3f2fd; padding: 16px 20px; border-radius: 4px; border-left: 4px solid #2196f3;">
                            <p style="margin: 0; color: #1565c0; font-size: 13px; line-height: 1.6;">
                                <strong>{{trans "Note:"}}</strong> {{trans "This is an automated error notification. Identical errors are grouped together and will not trigger multiple notifications within the configured throttle period."}}
                            </p>
                        </div>
                    </td>
                </tr>

                <!-- Footer -->
                <tr>
                    <td style="background-color: #f8f9fa; padding: 20px 30px; text-align: center; border-radius: 0 0 8px 8px; border-top: 1px solid #e9ecef;">
                        <p style="margin: 0 0 8px 0; color: #666; font-size: 12px;">
                            {{trans "Automated alert from"}} <strong>{{var frontend_store.name}} {{trans "Error Monitor"}}</strong>
                        </p>
                        <p style="margin: 0; color: #999; font-size: 11px;">
                            {{trans "This is an automated message. Please do not reply to this email."}}
                        </p>
                    </td>
                </tr>
            </table>
        </td>
    </tr>
</table>
</body>
</html>